{% extends "base.html" %}

{% block title %}About - CIS4496 GAN Project{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Project Description -->
    <div class="mb-5">
        <h2 class="display-4 text-dark alert alert-info">Project Description</h2>
        <p class="lh-sm font-monospace text-dark">
            Our project is titled
            <a href="https://www.kaggle.com/c/gan-getting-started" class="link-success" target="_blank">
                "I am Something of a Painter Myself,"
            </a>
            it is a GAN(generative adversarial network) related competition
            conducted on Kaggle. A GAN allows you to imitate the unique color
            choices and brushstrokes employed by renowned artists such as Monet.
            The goal of this competition is to create a GAN that will output
            images in the style of a Monet to trick classifiers into believing
            that it is a true Monet, not a generated one. The better quality your
            images can mimic a Monet, the lower your MiFID (Memorization-informed
            Fréchet Inception Distance) and the higher you will move up in the
            leaderboard.
        </p>
    </div>

    <!-- Model -->
    <div class="mb-5">
        <h2 class="display-4 text-dark alert alert-success">Model</h2>
        <figure class="figure">
            <img src="{{ url_for('static', filename='images/cyclegan-architecture.svg') }}"
                class="figure-img img-fluid rounded" alt="Our project model with CycleGAN" />
            <figcaption class="figure-caption">
                Our Project Model Using the CycleGAN
            </figcaption>
        </figure>
        <p class="lh-sm font-monospace text-dark">
            The modeling algorithm used for our project was a specific type of
            GAN, the cycleGAN. The cycleGAN specializes in image-to-image
            translation which is how we can convert a normal image into one
            resembling the styles of our artists. The cycleGAN consists of a
            source and target domain. The source domain consists of non-painting
            images and the target domain consists of paintings by the artists. The
            cycleGAN also consists of two generators and two discriminators. One
            generator's job is to take images from the source domain and turn them
            into the target domain. The second generator does the opposite of the
            first domain. The discriminator takes in the real images from the
            target domain and the generated images from the generator to predict
            if they are real or fake.
        </p>
    </div>

    <!-- Evaluation Metric -->
    <div class="mb-5">
        <h2 class="display-4 text-dark alert alert-danger">Evaluation Metric</h2>
        <p class="lh-sm font-monospace text-dark">
            "The Frechet Inception Distance score, or FID for short, is a metric
            that calculates the distance between feature vectors calculated for
            real and generated images. The score summarizes how similar the two
            groups are in terms of statistics on computer vision features of the
            raw images calculated using the inception v3 model used for image
            classification. Lower scores indicate the two groups of images are
            more similar, or have more similar statistics, with a perfect score
            being 0.0 indicating that the two groups of images are identical. The
            FID score is used to evaluate the quality of images generated by
            generative adversarial networks, and lower scores have been shown to
            correlate well with higher quality images." [<a
                href="https://machinelearningmastery.com/how-to-implement-the-frechet-inception-distance-fid-from-scratch/"
                class="link-warning" target="_blank">How to Implement the Frechet Inception Distance (FID) for
                Evaluating GANs by Jason Brownlee on Machine Learning Mastery</a>]
        </p>
        <p class="lh-sm font-monospace text-dark">
            In FID, we use the Inception network to extract features from an
            intermediate layer. Then we model the data distribution for these
            features using a multivariate Gaussian distribution with mean µ and
            covariance Σ. The FID between the real images and generated images is
            computed as:
        </p>
        <p class="fw-bold text-center">
            FID = ||μ<sub>r</sub> - μ<sub>g</sub>||² + Tr(Σ<sub>r</sub> + Σ<sub>g</sub> -
            2(Σ<sub>r</sub>Σ<sub>g</sub>)<sup>1/2</sup>)
        </p>
        <p class="lh-sm font-monospace text-dark">
            where sums up all the diagonal elements. FID is calculated by
            computing the Fréchet distance between two Gaussians fitted to feature
            representations of the Inception network.
        </p>
        <p class="lh-sm font-monospace text-dark">
            MiFID is the modified FID score that penalizes models producing images
            too similar to the training set,
        </p>
        <p class="fw-bold text-center">
            MiFID(S<sub>g</sub>, S<sub>t</sub>) = m<sub>τ</sub>(S<sub>g</sub>, S<sub>t</sub>) · FID(S<sub>g</sub>,
            S<sub>t</sub>)
        </p>
        <p class="lh-sm font-monospace text-dark">
            where S<sub>g</sub> is the generated set and S<sub>t</sub> is the original training set. m<sub>τ</sub>
            is the memorization penalty which is based on thresholding the
            memorization distance s of generated and true distribution.
        </p>
        <div class="alert alert-primary d-flex align-items-center" role="alert">
            <i class="bi bi-info-circle-fill me-2"></i>
            <div>
                If you are interesting in learning more about the evaluation metric
                for GANs, please refer to
                <a href="https://www.kaggle.com/competitions/gan-getting-started/overview/evaluation"
                    class="link-primary">
                    https://www.kaggle.com/competitions/gan-getting-started/overview/evaluation
                </a>
                and
                <a href="https://arxiv.org/abs/2103.09396" class="link-primary">
                    https://arxiv.org/abs/2103.09396
                </a>
            </div>
        </div>
    </div>

    <!-- Generated Images Showcase -->
    <div class="mb-5">
        <h2 class="display-4 text-dark alert alert-warning">
            Generated Images Showcase
        </h2>
        <div class="row">
            <div class="col-md-4 text-center">
                <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/1.jpg') }}"
                    alt="Generated Art 1" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/15.jpg') }}"
                    alt="Generated Art 2" />
            </div>

            <div class="col-md-4 text-center">
                <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/45.jpg') }}"
                    alt="Generated Art 3" />
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-4 text-center">
                <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/71.jpg') }}"
                    alt="Generated Art 4" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/169.jpg') }}"
                    alt="Generated Art 5" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/247.jpg') }}"
                    alt="Generated Art 6" />
            </div>
        </div>
    </div>

    <!-- Test Cases: Photos vs Paintings -->
    <div class="mb-5">
        <h2 class="display-4 text-dark alert alert-primary">
            Test Cases: Photos vs Paintings
        </h2>
        <div class="row mb-3">
            <div class="col-12 text-center">
                <div class="d-inline-block me-3">
                    <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/original1.jpg') }}"
                        alt="Original Photo" />
                    <p class="small mt-1">Original Photo</p>
                </div>
                <div class="d-inline-block">
                    <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/monet1.jpg') }}"
                        alt="Monet Style Output" />
                    <p class="small mt-1">Monet Style Output</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 text-center">
                <div class="d-inline-block me-3">
                    <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/original1.jpg') }}"
                        alt="Original Photo" />
                    <p class="small mt-1">Original Photo</p>
                </div>
                <div class="d-inline-block">
                    <img class="img-thumbnail" src="{{ url_for('static', filename='images/examples/vangogh1.jpg') }}"
                        alt="Van Gogh Style Output" />
                    <p class="small mt-1">Van Gogh Style Output</p>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="container">
    <p class="text-center text-muted">© Temple University - CIS 4496 Projects in Data Science</p>
</footer>
{% endblock %}

{% block scripts %}
<script>
    // Add MathJax for mathematical formulas
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
    };

    // Load MathJax
    (function () {
        var script = document.createElement('script');
        script.src = 'https://polyfill.io/v3/polyfill.min.js?features=es6';
        document.head.appendChild(script);

        script = document.createElement('script');
        script.id = 'MathJax-script';
        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js';
        script.async = true;
        document.head.appendChild(script);
    })();
</script>
{% endblock %}