{% extends "base.html" %}

{% block title %}About - CIS4496 GAN Project{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Project Description -->
    <div class="mb-5">
        <h2 class="display-4 alert alert-info border-0">Project Description</h2>
        <p class="lh-sm">
            Our project is titled
            <a href="https://www.kaggle.com/c/gan-getting-started" class="text-decoration-none text-info"
                target="_blank">
                "I am Something of a Painter Myself,"
            </a>
            it is a GAN(generative adversarial network) related competition
            conducted on Kaggle. A GAN allows you to imitate the unique color
            choices and brushstrokes employed by renowned artists such as Monet.
            The goal of this competition is to create a GAN that will output
            images in the style of a Monet to trick classifiers into believing
            that it is a true Monet, not a generated one. The better quality your
            images can mimic a Monet, the lower your MiFID (Memorization-informed
            Fréchet Inception Distance) and the higher you will move up in the
            leaderboard.
        </p>
    </div>

    <!-- Model -->
    <div class="mb-5">
        <h2 class="display-4 alert alert-success border-0">Model</h2>
        <figure class="figure text-center d-flex flex-column align-items-center justify-content-center">
            <img src="{{ url_for('static', filename='images/cyclegan-architecture.svg') }}"
                class="figure-img img-fluid rounded bg-light p-3" alt="Our project model with CycleGAN" />
            <figcaption class="figure-caption text-muted mt-2">
                Our Project Model Using the CycleGAN
            </figcaption>
        </figure>
        <p class="lh-sm">
            The modeling algorithm used for our project was a specific type of
            GAN, the cycleGAN. The cycleGAN specializes in image-to-image
            translation which is how we can convert a normal image into one
            resembling the styles of our artists. The cycleGAN consists of a
            source and target domain. The source domain consists of non-painting
            images and the target domain consists of paintings by the artists. The
            cycleGAN also consists of two generators and two discriminators. One
            generator's job is to take images from the source domain and turn them
            into the target domain. The second generator does the opposite of the
            first domain. The discriminator takes in the real images from the
            target domain and the generated images from the generator to predict
            if they are real or fake.
        </p>
    </div>

    <!-- Evaluation Metric -->
    <div class="mb-5">
        <h2 class="display-4 alert alert-danger border-0">Evaluation Metric</h2>
        <p class="lh-sm">
            "The Frechet Inception Distance score, or FID for short, is a metric
            that calculates the distance between feature vectors calculated for
            real and generated images. The score summarizes how similar the two
            groups are in terms of statistics on computer vision features of the
            raw images calculated using the inception v3 model used for image
            classification. Lower scores indicate the two groups of images are
            more similar, or have more similar statistics, with a perfect score
            being 0.0 indicating that the two groups of images are identical. The
            FID score is used to evaluate the quality of images generated by
            generative adversarial networks, and lower scores have been shown to
            correlate well with higher quality images." [<a
                href="https://machinelearningmastery.com/how-to-implement-the-frechet-inception-distance-fid-from-scratch/"
                class="text-decoration-none text-warning" target="_blank">How to Implement the Frechet Inception
                Distance (FID) for
                Evaluating GANs by Jason Brownlee on Machine Learning Mastery</a>]
        </p>
        <p class="lh-sm">
            In FID, we use the Inception network to extract features from an
            intermediate layer. Then we model the data distribution for these
            features using a multivariate Gaussian distribution with mean µ and
            covariance Σ. The FID between the real images and generated images is
            computed as:
        </p>
        <div class="bg-secondary p-3 rounded my-3">
            <p class="fw-bold text-center mb-0 text-light">
                FID = ||μ<sub>r</sub> - μ<sub>g</sub>||² + Tr(Σ<sub>r</sub> + Σ<sub>g</sub> -
                2(Σ<sub>r</sub>Σ<sub>g</sub>)<sup>1/2</sup>)
            </p>
        </div>
        <p class="lh-sm">
            where sums up all the diagonal elements. FID is calculated by
            computing the Fréchet distance between two Gaussians fitted to feature
            representations of the Inception network.
        </p>
        <p class="lh-sm">
            MiFID is the modified FID score that penalizes models producing images
            too similar to the training set,
        </p>
        <div class="bg-secondary p-3 rounded my-3">
            <p class="fw-bold text-center mb-0 text-light">
                MiFID(S<sub>g</sub>, S<sub>t</sub>) = m<sub>τ</sub>(S<sub>g</sub>, S<sub>t</sub>) · FID(S<sub>g</sub>,
                S<sub>t</sub>)
            </p>
        </div>
        <p class="lh-sm">
            where S<sub>g</sub> is the generated set and S<sub>t</sub> is the original training set. m<sub>τ</sub>
            is the memorization penalty which is based on thresholding the
            memorization distance s of generated and true distribution.
        </p>
        <div class="alert alert-primary d-flex align-items-center border-0" role="alert">
            <i class="bi bi-info-circle-fill me-2"></i>
            <div>
                If you are interesting in learning more about the evaluation metric
                for GANs, please refer to
                <a href="https://www.kaggle.com/competitions/gan-getting-started/overview/evaluation"
                    class="text-decoration-none text-info">
                    https://www.kaggle.com/competitions/gan-getting-started/overview/evaluation
                </a>
                and
                <a href="https://arxiv.org/abs/2103.09396" class="text-decoration-none text-info">
                    https://arxiv.org/abs/2103.09396
                </a>
            </div>
        </div>
    </div>

    <!-- Generated Images Showcase -->
    <div class="mb-5">
        <h2 class="display-4 alert alert-warning border-0 text-dark">
            Generated Images Showcase
        </h2>
        <div class="row g-3">
            <div class="col-md-4 text-center">
                <img class="img-thumbnail bg-light" src="{{ url_for('static', filename='images/examples/1.jpg') }}"
                    alt="Generated Art 1" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail bg-light" src="{{ url_for('static', filename='images/examples/15.jpg') }}"
                    alt="Generated Art 2" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail bg-light" src="{{ url_for('static', filename='images/examples/45.jpg') }}"
                    alt="Generated Art 3" />
            </div>
        </div>
        <div class="row g-3 mt-2">
            <div class="col-md-4 text-center">
                <img class="img-thumbnail bg-light" src="{{ url_for('static', filename='images/examples/71.jpg') }}"
                    alt="Generated Art 4" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail bg-light" src="{{ url_for('static', filename='images/examples/169.jpg') }}"
                    alt="Generated Art 5" />
            </div>
            <div class="col-md-4 text-center">
                <img class="img-thumbnail bg-light" src="{{ url_for('static', filename='images/examples/247.jpg') }}"
                    alt="Generated Art 6" />
            </div>
        </div>
    </div>

    <!-- Test Cases: Photos vs Paintings -->
    <div class="mb-5">
        <h2 class="display-4 alert alert-primary border-0">
            Test Cases: Photos vs Paintings
        </h2>
        <div class="row mb-4">
            <div class="col-12 text-center">
                <div class="d-inline-block me-4">
                    <img class="img-thumbnail bg-light"
                        src="{{ url_for('static', filename='images/examples/Mountain2.jpg') }}" alt="Original Photo"
                        style="max-width: 300px;" />
                    <p class="small mt-2 text-muted">Original Photo</p>
                </div>
                <div class="d-inline-block">
                    <img class="img-thumbnail bg-light"
                        src="{{ url_for('static', filename='images/examples/Mountain2Output.jpg') }}"
                        alt="Monet Style Output" style="max-width: 300px;" />
                    <p class="small mt-2 text-muted">Output Painting</p>
                </div>
            </div>
        </div>
        <div class="row mb-4">
            <div class="col-12 text-center">
                <div class="d-inline-block me-4">
                    <img class="img-thumbnail bg-light"
                        src="{{ url_for('static', filename='images/examples/City2.jpg') }}" alt="Original Photo"
                        style="max-width: 300px;" />
                    <p class="small mt-2 text-muted">Original Photo</p>
                </div>
                <div class="d-inline-block">
                    <img class="img-thumbnail bg-light"
                        src="{{ url_for('static', filename='images/examples/City2Output.jpg') }}"
                        alt="Monet Style Output" style="max-width: 300px;" />
                    <p class="small mt-2 text-muted">Output Painting</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 text-center">
                <div class="d-inline-block me-4">
                    <img class="img-thumbnail bg-light"
                        src="{{ url_for('static', filename='images/examples/Nature2.jpg') }}" alt="Original Photo"
                        style="max-width: 300px;" />
                    <p class="small mt-2 text-muted">Original Photo</p>
                </div>
                <div class="d-inline-block">
                    <img class="img-thumbnail bg-light"
                        src="{{ url_for('static', filename='images/examples/Nature2Output.jpg') }}"
                        alt="Van Gogh Style Output" style="max-width: 300px;" />
                    <p class="small mt-2 text-muted">Output Painting</p>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="container border-top border-secondary pt-4">
    <p class="text-center text-muted">© Temple University - CIS 4496 Projects in Data Science</p>
</footer>
{% endblock %}

{% block scripts %}
<script>
    // Add MathJax for mathematical formulas
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
    };

    // Load MathJax
    (function () {
        var script = document.createElement('script');
        script.src = 'https://polyfill.io/v3/polyfill.min.js?features=es6';
        document.head.appendChild(script);

        script = document.createElement('script');
        script.id = 'MathJax-script';
        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js';
        script.async = true;
        document.head.appendChild(script);
    })();
</script>
{% endblock %}